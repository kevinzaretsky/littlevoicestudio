'use client'; import { create } from 'zustand'; export type CartItem={id:string;productSlug:string;color:string;epoxy:'yes'|'no';unitPriceCents:number;qty:number;imagePublicIds:string[]}; type CartState={items:CartItem[];add:(i:CartItem)=>void;remove:(id:string)=>void;clear:()=>void}; const key='lvs_cart_v1'; const load=()=>{try{return JSON.parse(localStorage.getItem(key)||'[]')}catch{return[]}}; const save=(x:any)=>localStorage.setItem(key, JSON.stringify(x)); export const useCart=create<CartState>((set)=>({items:typeof window!=='undefined'?load():[],add:(i)=>set(s=>{const n=[...s.items,i];save(n);return{items:n}}),remove:(id)=>set(s=>{const n=s.items.filter(x=>x.id!==id);save(n);return{items:n}}),clear:()=>set(()=>{save([]);return{items:[]}})}));